{% extends 'club/base.html.twig' %}

{% block page_title %}
	{{ 'pendingInvitations'|trans }}
{% endblock %}

{% block page_actions %}
	<div class="d-flex gap-2">
		<a href="{{ path('club_invitation_import') }}" class="btn btn-secondary" style="min-height: 44px;">
			<i class="ti ti-file-upload me-2"></i>
			<span class="d-none d-sm-inline">{{ 'import'|trans }}</span>
			<span class="d-inline d-sm-none">{{ 'import'|trans }}</span>
		</a>
		<a href="{{ path('club_invitation_create') }}" class="btn btn-primary" style="min-height: 44px;">
			<i class="ti ti-plus me-2"></i>
			<span class="d-none d-sm-inline">{{ 'invite'|trans }}</span>
			<span class="d-inline d-sm-none">{{ 'invite'|trans }}</span>
		</a>
	</div>
{% endblock %}

{% block page_content %}
	{# Invitation cards - Mobile-first design, full-width #}
	<div class="row">
		{% for invitation in invitations %}
			<div class="col-12 mb-3">
				<a href="{{ path('club_invitation_show', {id: invitation.id}) }}" class="text-decoration-none">
					<div class="card card-link" style="cursor: pointer;">
						<div class="card-body">
							<div
								class="d-flex align-items-start mb-3">
								{# Mail Avatar - similar to task list's equipment avatar #}
								<span class="avatar avatar-lg me-3 bg-yellow-lt">
									<i class="ti ti-mail text-yellow" style="font-size: 1.5rem;"></i>
								</span>

								{# Main content #}
								<div
									class="flex-grow-1">
									{# Name/Email (main title) #}
									<h3 class="card-title mb-1">
										{% if invitation.fullname %}
											{{ invitation.fullname }}
										{% else %}
											{{ invitation.email }}
										{% endif %}
									</h3>

									{# Email (subtitle if name exists) #}
									{% if invitation.fullname %}
										<div class="text-secondary mb-2">
											{{ invitation.email }}
										</div>
									{% endif %}

									{# Dates #}
									<div class="text-secondary small">
										<i class="ti ti-calendar me-1"></i>
										{{ 'sentOn'|trans }}
										{{ invitation.createdAt|date('d/m/Y') }}
										<span class="mx-2">â€¢</span>
										<i class="ti ti-clock me-1"></i>
										{{ 'expiresOn'|trans }}
										{{ invitation.expiresAt|date('d/m/Y') }}
									</div>
								</div>

								{# Badges on desktop - right side #}
								<div
									class="ms-3 d-none d-md-flex gap-2 align-items-start">
									{# Roles badges #}
									{% if invitation.isManager %}
										<span class="badge bg-blue text-white">
											<i class="ti ti-shield me-1"></i>
											{{ 'manager'|trans }}
										</span>
									{% endif %}
									{% if invitation.isInspector %}
										<span class="badge bg-green text-white">
											<i class="ti ti-eye-check me-1"></i>
											{{ 'inspector'|trans }}
										</span>
									{% endif %}
									{% if invitation.isPilote %}
										<span class="badge bg-purple text-white">
											<i class="ti ti-plane me-1"></i>
											{{ 'pilot'|trans }}
										</span>
									{% endif %}
									{% if not invitation.isManager and not invitation.isInspector and not invitation.isPilote %}
										<span class="badge bg-secondary text-white">
											<i class="ti ti-user me-1"></i>
											{{ 'member'|trans }}
										</span>
									{% endif %}

									{# Locked status #}
									{% if invitation.isLocked %}
										<span class="badge bg-info text-white">
											<i class="ti ti-lock me-1"></i>
											{{ 'existingUser'|trans }}
										</span>
									{% endif %}
								</div>
							</div>

							{# Badges on mobile - full width under avatar #}
							<div
								class="d-flex d-md-none gap-2 flex-wrap">
								{# Roles badges #}
								{% if invitation.isManager %}
									<span class="badge bg-blue text-white">
										<i class="ti ti-shield me-1"></i>
										{{ 'manager'|trans }}
									</span>
								{% endif %}
								{% if invitation.isInspector %}
									<span class="badge bg-green text-white">
										<i class="ti ti-eye-check me-1"></i>
										{{ 'inspector'|trans }}
									</span>
								{% endif %}
								{% if invitation.isPilote %}
									<span class="badge bg-purple text-white">
										<i class="ti ti-plane me-1"></i>
										{{ 'pilot'|trans }}
									</span>
								{% endif %}
								{% if not invitation.isManager and not invitation.isInspector and not invitation.isPilote %}
									<span class="badge bg-secondary text-white">
										<i class="ti ti-user me-1"></i>
										{{ 'member'|trans }}
									</span>
								{% endif %}

								{# Locked status #}
								{% if invitation.isLocked %}
									<span class="badge bg-info text-white">
										<i class="ti ti-lock me-1"></i>
										{{ 'existingUser'|trans }}
									</span>
								{% endif %}
							</div>
						</div>
					</div>
				</a>
			</div>
		{% else %}
			<div class="col-12">
				<div class="card">
					<div class="card-body text-center text-secondary">
						<i class="ti ti-mail-opened" style="font-size: 3rem; opacity: 0.5;"></i>
						<p class="mt-3 mb-0">
							<em>{{ 'noPendingInvitations'|trans }}</em>
						</p>
						<a href="{{ path('club_invitation_create') }}" class="btn btn-primary mt-3" style="min-height: 44px;">
							<i class="ti ti-plus me-2"></i>
							{{ 'inviteNewMember'|trans }}
						</a>
					</div>
				</div>
			</div>
		{% endfor %}
	</div>

	{# Pagination #}
	<div class="d-flex justify-content-center mt-4">
		{{ pagination(invitations) }}
	</div>
{% endblock %}
