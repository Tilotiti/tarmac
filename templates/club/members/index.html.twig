{% extends 'club/base.html.twig' %}

{% block page_title %}
	{{ 'members'|trans }}
{% endblock %}

{% block page_actions %}
	{% if is_granted('MANAGE', club) %}
		<a href="{{ path('club_invitations') }}" class="btn btn-outline-primary" style="min-height: 44px;">
			<i class="ti ti-mail me-2"></i>
			<span class="d-none d-sm-inline">{{ 'invitations'|trans }}</span>
			<span class="d-inline d-sm-none">{{ 'invitations'|trans }}</span>
		</a>
	{% endif %}
{% endblock %}

{% block page_content %}
	{% include 'component/filters.html.twig' with { form: filters } %}

	{# Member cards - Mobile-first design #}
	<div class="row">
		{% for membership in memberships %}
			<div class="col-12 col-md-6 col-lg-4 mb-3">
				<a href="{{ path('club_member_show', {id: membership.id}) }}" class="text-decoration-none">
					<div class="card h-100 card-link {% if not membership.user.active %}border-danger{% endif %}" style="cursor: pointer;">
						<div class="card-body">
							<div class="d-flex align-items-start mb-3">
								<span class="avatar me-3">{{ membership.user.firstname[:1] }}{{ membership.user.lastname[:1] }}</span>
								<div class="flex-fill">
									<div class="font-weight-medium {% if not membership.user.active %}text-danger{% else %}text-dark{% endif %}">
										{{ membership.user.fullname }}
									</div>
									<div class="text-secondary small">{{ membership.user.email }}</div>

									{# Roles #}
									<div class="mt-2">
										{% if membership.isManager %}
											<span class="badge bg-blue-lt me-1">{{ 'manager'|trans }}</span>
										{% endif %}
										{% if membership.isInspector %}
											<span class="badge bg-green-lt">{{ 'inspector'|trans }}</span>
										{% endif %}
										{% if not membership.isManager and not membership.isInspector %}
											<span class="text-muted small">{{ 'member'|trans }}</span>
										{% endif %}
									</div>

									{# Status #}
									{% if not membership.user.active %}
										<div class="mt-2">
											<span class="badge bg-danger">{{ 'disabled'|trans }}</span>
										</div>
									{% endif %}
								</div>
							</div>

							<div class="text-secondary small">
								<i class="ti ti-calendar me-1"></i>
								{{ 'memberSince'|trans }}
								{{ membership.joinedAt|date('d/m/Y') }}
							</div>
						</div>
					</div>
				</a>
			</div>
		{% else %}
			<div class="col-12">
				<div class="card">
					<div class="card-body text-center text-secondary">
						<em>{{ 'noMembersFound'|trans }}</em>
					</div>
				</div>
			</div>
		{% endfor %}
	</div>

	{# Pagination #}
	<div class="d-flex justify-content-center mt-4">
		{{ pagination(memberships) }}
	</div>
{% endblock %}
